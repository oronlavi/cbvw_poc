<!-- For ease i'm just using a JQuery version hosted by JQuery- you can download any version and link to it locally -->
<script src="http://code.jquery.com/jquery-latest.js"></script>

<script>
    var refreshId = setInterval(function () {
        $('#scoreboard').fadeOut("slow").load('/home/1').fadeIn("slow");
    }, 5000);
</script>

<!-- <script type="text/javascript">
    function Ajax(){
        var xmlHttp;
        try{
            xmlHttp=new XMLHttpRequest();// Firefox, Opera 8.0+, Safari
        }catch (e){
            try{
                xmlHttp=new ActiveXObject("Msxml2.XMLHTTP"); // Internet Explorer
            }catch (e){
                try{
                    xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
                }catch (e){
                    alert("No AJAX!?");
                    return false;
                }
            }
        }
        xmlHttp.onreadystatechange=function(){
            document.getElementById('rightbar').innerHTML=xmlHttp.responseText;
            setTimeout('Ajax()',5000);
        }
        xmlHttp.open("GET",'home/1',true);
        xmlHttp.send(null);
    }
    window.onload=function(){
        setTimeout('Ajax()',5000);
    }
</script>
-->

<!-- <div class="container-fluid"> -->
<!-- <meta http-equiv="refresh" content="30" /> -->
<%= image_tag "/images/news_part1_imageonly.png", class: "faux_website_image" %>
<div class="container-fluid grey_background">
  <div class="row-fluid">
    <div class="span8">
      <div id="headline1">

        <% item = NewsItem.last %>
        <% if !item.nil? %>
            <img src="images/face.png" class="news_face">

            <h1><%= raw set_article_vars(item.news_template.major.upcase, item.match) %></h1>

            <h2><%= raw set_article_vars(item.news_template.minor, item.match) %></h2>

            <p><%= raw set_article_vars(truncate(item.news_template.detail,
                                                 :length => 300, :omission => "... Read More!", :separator => ' '),
                                        item.match) %></p>
        <% end %>

      </div>
    </div>
    <div class="span4 center">
      <aside id="scoreboard"><%= render 'layouts/live_score' %></aside>

      <aside>
        <table width="100%">
          <tr>
            <th>Pos</th>
            <th>User</th>
            <th>P</th>
            <th>W</th>
            <th>L</th>
            <th>GD</th>
            <th>Pts</th>
          </tr>

          <% rank = 0 %>
          <% @users.sort { |a, b|
            if pts(b) == pts(a) then
              gd(b) <=> gd(a)
            else
              pts(b) <=> pts(a)
            end }.each do |user| %>
              <% rank += 1 %>
              <tr>
                <td><%= rank %></td>
                <td><%= link_to user.username, "/home/" + user.id.to_s %></td>
                <td><%= matches_played(user) %></td>
                <td><%= matches_won(user) %></td>
                <td><%= matches_lost(user) %></td>
                <td><%= gd(user) %></td>
                <td><%= pts(user) %></td>
              </tr>
          <% end %>
        </table>
      </aside>
    </div>
  </div>
</div>

<%= image_tag "/images/news_part3_imageonly.png", class: "faux_website_image" %>
<!-- </div> -->